

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Design Guidelines to create a new ODA Component &mdash; ODA-Component Accelerator v1beta1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Design Guidelines to design an ODA Canvas" href="ODACanvasDesignGuidelines.html" />
    <link rel="prev" title="Tutorial to build ODA-Component from Open-API Reference Implemenation" href="ODAComponentTutorial/README.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ODA-Component Accelerator
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">About the project:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Playbook.html">Introduction to the ODA Component Accelerator Project (ODA-CA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting_started.html">Getting started checklist for new members of ODA-CA</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Observability-Tutorial/README.html">Tutorial to deploy and observe a running component</a></li>
<li class="toctree-l1"><a class="reference internal" href="ODAComponentTutorial/README.html">Tutorial to build ODA-Component from Open-API Reference Implemenation</a></li>
</ul>
<p class="caption"><span class="caption-text">Design Guidelines:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Design Guidelines to create a new ODA Component</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#step-1-oda-component-metadata">Step 1: ODA-Component Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-2-add-labels-to-all-the-standard-kubernetes-resources">Step 2: Add labels to all the standard Kubernetes resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ODACanvasDesignGuidelines.html">Design Guidelines to design an ODA Canvas</a></li>
</ul>
<p class="caption"><span class="caption-text">Compliance Test Kit (CTK):</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ctk/README.html">ODA Component - CTK</a></li>
</ul>
<p class="caption"><span class="caption-text">Canvas Helm Charts:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../canvas/index.html">Open Digital Architecture - Canvas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../canvas/Specification.html">ODA Reference Implementation and Environment Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../canvas/Installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Canvas Operators:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../canvas/source/operators/index.html">Open Digital Architecture - Controllers/Operators</a></li>
</ul>
<p class="caption"><span class="caption-text">Troubleshooting Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TroubleshootingGuide/index.html">ODA-CA Troubleshooting Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributions Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ContributionsGuide.html">Contribution guidance</a></li>
<li class="toctree-l1"><a class="reference internal" href="DocumentationProcess.html">Documentation Process</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ODA-Component Accelerator</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Design Guidelines to create a new ODA Component</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/docs/ODAComponentDesignGuidelines.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="design-guidelines-to-create-a-new-oda-component">
<h1>Design Guidelines to create a new ODA Component<a class="headerlink" href="#design-guidelines-to-create-a-new-oda-component" title="Permalink to this headline">¶</a></h1>
<p>ODA Components are self-contained, independently deployable software modules that confirm to the <a class="reference external" href="https://tmforum.org/oda">TM Forum Open Digital Architecture</a>.</p>
<p>The business drivers and conceptual model for ODA Components is described in <a class="reference external" href="https://projects.tmforum.org/wiki/display/PUB/IG1171%20ODA%20Component%20Definition%20R19.0.1">IG1171 ODA Component Definition</a>.</p>
<p>The ODA Component concept builds on top of open standards like Docker and Kubernetes, and adds Telco-domain knowledge and meta-data. The starting point for building an ODA component is containerized, micro-service software described in a kubernetes manifest YAML file. To turn this into an ODA Component we will:</p>
<ol class="simple">
<li><p>Add meta-data to the Kubernetes manifest describing the <em>Core Function</em>, <em>Notification/Reporting</em>, <em>Security</em> and <em>Management &amp; Operation</em> of the software component.</p></li>
<li><p>Add labels to all the standard Kubernetes resources to label them as belonging to the component.</p></li>
<li><p>Test the deployment of the Component in an operating platform that has the ODA Canvas installed (for example the TM FOrum Open-Digital Lab). See the <a class="reference external" href="https://github.com/tmforum-rand/oda-component-definitions#get-started">Getting Started</a> section to see how to install the ODA Canvas onto a kubernetes cluster environmnet.</p></li>
</ol>
<div class="section" id="step-1-oda-component-metadata">
<h2>Step 1: ODA-Component Metadata<a class="headerlink" href="#step-1-oda-component-metadata" title="Permalink to this headline">¶</a></h2>
<p>This guide has been updated to conform to the <a class="reference external" href="Component-OAS-Specification-v1beta1.yaml">v1beta1 component specification</a>.</p>
<p>The ODA-Component metadata contains all the Telco-domain knowledge that makes the component a self-describing deployable software module. From <a class="reference external" href="https://projects.tmforum.org/wiki/display/PUB/IG1171%20ODA%20Component%20Definition%20R19.0.1">IG1171 ODA Component Definition</a>, this meta-data describes the Open-APIs, event data schemas as well as security and management &amp; operations for the component.</p>
<p>The meta-data is defined using a Kubernetes <a class="reference external" href="https://kubernetes.io/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definitions/">CustomResourceDefinition</a>. This allows us to extend the Kubernetes API with our custom-defined schema for Telco meta-data. The CustomResourceDefinition schema is in the <a class="reference external" href="https://github.com/tmforum-oda/oda-canvas-charts/blob/master/canvas/charts/crds/templates">github.com/tmforum-oda/oda-canvas-charts</a> repository.</p>
<p>There is an example of the metadata for the <a class="reference external" href="https://github.com/tmforum-oda/oda-ca-docs/blob/master/examples/ProductCatalog/productcatalog/templates/component-productcatalog.yaml">productcatalog example component</a> broken-down into sections below:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">oda.tmforum.org/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">component</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vodafone-productcatalog</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="nt">oda.tmforum.org/componentName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vodafone-productcatalog</span>
    <span class="nt">oda.tmforum.org/funtionalBlockName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CoreCommerce</span>
</pre></div>
</div>
<p>This is the header information for the component, specifying the version of the CRD (Custom Resource Definition) that it is using, and providing a name and a label for the component and a label describing which functional block the component belongs to.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">spec</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">TMFC001-productcatalogmanagement</span>
  <span class="nt">version</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.0.3</span>
  <span class="nt">description</span><span class="p">:</span> <span class="s">&quot;Simple</span><span class="nv"> </span><span class="s">Product</span><span class="nv"> </span><span class="s">Catalog</span><span class="nv"> </span><span class="s">ODA-Component</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">Open-API</span><span class="nv"> </span><span class="s">reference</span><span class="nv"> </span><span class="s">implementation.&quot;</span> 
  <span class="nt">maintainers</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Lester Thomas</span>
    <span class="nt">email</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">lester.thomas@vodafone.com</span>
  <span class="nt">owners</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Lester Thomas</span>
    <span class="nt">email</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">lester.thomas@vodafone.com</span>  
</pre></div>
</div>
<p>This next section starts the <code class="docutils literal notranslate"><span class="pre">spec</span></code> for the component.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> allows us to specify that this is an implementation of a standard type of Component. If the <code class="docutils literal notranslate"><span class="pre">type</span></code> and <code class="docutils literal notranslate"><span class="pre">version</span></code> match one of the <strong>Golden Components</strong> then the Component CTK will test that the functional capability matches the requirements from that <strong>Golden Component</strong>. For a full list of all the standard ODA Components, see the <a class="reference external" href="https://oda-directory.labs.tmforum.org/">ODA Component Directory</a></p>
<p>The <code class="docutils literal notranslate"><span class="pre">description</span></code>, <code class="docutils literal notranslate"><span class="pre">maintainers</span></code> and <code class="docutils literal notranslate"><span class="pre">owners</span></code> are self-descriptive.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span>  <span class="nt">coreFunction</span><span class="p">:</span>
    <span class="nt">exposedAPIs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">productcatalogmanagement</span>
      <span class="nt">specification</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://raw.githubusercontent.com/tmforum-apis/TMF620_ProductCatalog/master/TMF620-ProductCatalog-v4.0.0.swagger.json</span>
      <span class="nt">implementation</span><span class="p">:</span> <span class="p p-Indicator">{{</span><span class="nv">.Release.Name</span><span class="p p-Indicator">}}</span><span class="l l-Scalar l-Scalar-Plain">-prodcatapi</span>
      <span class="nt">apitype</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">openapi</span>
      <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/{{.Release.Name}}-{{.Values.component.type}}/tmf-api/productCatalogManagement/v4</span>
      <span class="nt">developerUI</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/{{.Release.Name}}-{{.Values.component.type}}/tmf-api/productCatalogManagement/v4/docs</span>
      <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span>
    <span class="nt">dependantAPIs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">party</span> 
      <span class="nt">apitype</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">openapi</span>     
      <span class="nt">specification</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://open-api.tmforum.org/TMF632-Party-v4.0.0.swagger.json</span>     
    <span class="nt">publishedEvents</span><span class="p">:</span> 
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">TMF620-productspecification</span>
      <span class="nt">specification</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://open-api.tmforum.org/TMF620-Productcatalog-v4.0.0.swagger.json</span>
      <span class="nt">hub</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/{{.Release.Name}}-{{.Values.component.type}}/tmf-api/productspecification/hub</span>
      <span class="nt">implementation</span><span class="p">:</span> <span class="p p-Indicator">{{</span><span class="nv">.Release.Name</span><span class="p p-Indicator">}}</span><span class="l l-Scalar l-Scalar-Plain">-prodspecevent</span>
      <span class="nt">apitype</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">openapi</span>
      <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
    <span class="nt">subscribedEvents</span><span class="p">:</span> 
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">TMF633-servicespecification</span>
      <span class="nt">specification</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://open-api.tmforum.org/TMF633-Servicecatalog-v4.0.0.swagger.json</span>
      <span class="nt">call-back</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/{{.Release.Name}}-{{.Values.component.type}}/tmf-api/servicepecification/call-back</span>
      <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
      <span class="nt">implementation</span><span class="p">:</span> <span class="p p-Indicator">{{</span><span class="nv">.Release.Name</span><span class="p p-Indicator">}}</span><span class="l l-Scalar l-Scalar-Plain">-servicespecevent</span>
      <span class="nt">apitype</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">openapi</span>
      <span class="nt">filter</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CatalogStateChangeEvent&amp;status=active</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">coreFunction</span></code> describes the core purpose of the software component. It describes the list of APIs and/or events that the component exposes as well as the APIs and/or events that it is dependant on. The definitions within the <code class="docutils literal notranslate"><span class="pre">publishedEvents</span></code> and <code class="docutils literal notranslate"><span class="pre">subscribedEvents</span></code> are experimental at this point, and we will modify and enhance them as we build-out the ODA Canvas and assemble a representative set of ODA Components. The current definition has:</p>
<ul class="simple">
<li><p>an <code class="docutils literal notranslate"><span class="pre">implementation</span></code> which links to the Kubernetes service that implements the API or event, including the <code class="docutils literal notranslate"><span class="pre">port</span></code> where the http service is exposed.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> shows the API resource end-point, and can be used, for example, to automatically configure any API Gateway that is included as part of the Canvas. Note that the <code class="docutils literal notranslate"><span class="pre">path</span></code> points to the root of the API (and you need to append the relevant path from the swagger document to get to an implemented API resource).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">specification</span></code> points to the swagger documentation for the API. The Component CTK (Compliance Test Kit) will look inside this swagger for the <code class="docutils literal notranslate"><span class="pre">basePath</span></code> determine which Open-API CTK to execute for that API. The <code class="docutils literal notranslate"><span class="pre">basePath</span></code> is of format <code class="docutils literal notranslate"><span class="pre">&quot;/tmf-api/productCatalogManagement/v4/&quot;</span></code> which shows it is a <code class="docutils literal notranslate"><span class="pre">tmf-api</span></code> for <code class="docutils literal notranslate"><span class="pre">productCatalogManagement</span></code> with major version <code class="docutils literal notranslate"><span class="pre">4</span></code>. The swagger can be one of the TM Forum published swagger files (e.g. <a class="reference external" href="https://raw.githubusercontent.com/tmforum-rand/Open_API_And_Data_Model/v4.0-Sprint-2020-03/apis/TMF620_Product_Catalog/swaggers/TMF620-ProductCatalog-v4.1.0.swagger.json?token=ACS2FQP4M3AEZBKQQEMIUQ3ABGIBM">https://raw.githubusercontent.com/tmforum-rand/Open_API_And_Data_Model/v4.0-Sprint-2020-03/apis/TMF620_Product_Catalog/swaggers/TMF620-ProductCatalog-v4.1.0.swagger.json</a>) or can be an extension (conforming to the TMF630 Design Guidelines).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">hub</span></code> represents the path for configuring the destination for the events.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">call-back</span></code> represents the path to the call-back end-point for these events.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">filter</span></code> allows the component to define a filter to only subscribe to certain type of events.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span>  <span class="nt">management</span><span class="p">:</span>
    <span class="nt">exposedAPIs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">metrics</span>
      <span class="nt">apitype</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">open-metrics</span>
      <span class="nt">implementation</span><span class="p">:</span> <span class="p p-Indicator">{{</span><span class="nv">.Release.Name</span><span class="p p-Indicator">}}</span><span class="l l-Scalar l-Scalar-Plain">-{{.Values.component.name}}-sm</span>
      <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/{{.Release.Name}}-{{.Values.component.name}}/metrics</span>
      <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4000</span>    
    <span class="nt">dependantAPIs</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
    <span class="nt">publishedEvents</span><span class="p">:</span> 
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">TMF642-alarmmanagement</span>
      <span class="nt">specification</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://open-api.tmforum.org/TMF642-alarmmanagement-v4.0.0.swagger.json</span>
      <span class="nt">hub</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/{{.Release.Name}}-{{.Values.component.type}}/tmf-api/alarmmanagement/hub</span>
      <span class="nt">implementation</span><span class="p">:</span> <span class="p p-Indicator">{{</span><span class="nv">.Release.Name</span><span class="p p-Indicator">}}</span><span class="l l-Scalar l-Scalar-Plain">-alarmmgtevent</span>
      <span class="nt">apitype</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">openapi</span>
      <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
    <span class="nt">subscribedEvents</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
  <span class="nt">security</span><span class="p">:</span>
    <span class="nt">controllerRole</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">secConAdmin</span>
    <span class="nt">exposedAPIs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">partyrole</span>
      <span class="nt">specification</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://raw.githubusercontent.com/tmforum-apis/TMF669_PartyRole/master/TMF669-PartyRole-v4.0.0.swagger.json</span>
      <span class="nt">implementation</span><span class="p">:</span> <span class="p p-Indicator">{{</span><span class="nv">.Release.Name</span><span class="p p-Indicator">}}</span><span class="l l-Scalar l-Scalar-Plain">-partyroleapi</span>
      <span class="nt">apitype</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">openapi</span>
      <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/{{.Release.Name}}-{{.Values.component.name}}/tmf-api/partyRoleManagement/v4</span>
      <span class="nt">developerUI</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/{{.Release.Name}}-{{.Values.component.name}}/tmf-api/partyRoleManagement/v4/docs</span>
      <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span> 
    <span class="nt">dependantAPIs</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">management</span></code> and <code class="docutils literal notranslate"><span class="pre">security</span></code> sections describe management and security APIs the component exposes that are part of its management or security (rather than part of its core business function). Examples of management APIs are for self-testing, raising operational alarms, or configuring the component itself. The <code class="docutils literal notranslate"><span class="pre">security</span></code> section provides meta-data on the security mechanisms used by the component, for example, exposing the roles the component requires to be configured in the Identity Management service. Again, the current definitions within these sections are experimental and we will modify and enhance them as we build-out the ODA Canvas and assemble a representative set of ODA Components. As of version <code class="docutils literal notranslate"><span class="pre">v1alpha2</span></code> and later, the security definition should include a <code class="docutils literal notranslate"><span class="pre">partyrole</span></code> property that describes the TMF669 PartyRole Open-API that all components must support (future versions may support multiple mechanisms for components to expose the roles they support). As of version <code class="docutils literal notranslate"><span class="pre">v1alpha3</span></code> and layer, the security definition must include a <code class="docutils literal notranslate"><span class="pre">controllerRole</span></code> property that gives the name of a pre-existing role in the component that the security controller can use to a) POST a listener URL to the component partyRole notification endpoint so that it can receive notifications of events against party roles and b) GET the partyrole endpoint to query roles in the component.</p>
</div>
<div class="section" id="step-2-add-labels-to-all-the-standard-kubernetes-resources">
<h2>Step 2: Add labels to all the standard Kubernetes resources<a class="headerlink" href="#step-2-add-labels-to-all-the-standard-kubernetes-resources" title="Permalink to this headline">¶</a></h2>
<p>By default, when you deploy a kubernetes manifest containing a number of different standard resources (Deployments, Pods, Services etc), they are deployed as independant resources with no reference to each-other. As part of the component standard, we add a label to every kubernetes resource to show that it belongs to a particular component.</p>
<p>In our productcatalog example component, if you look at the service definition below, it shows us adding the component label to this service.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">productcatalog</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">productcatalog</span>
    <span class="nt">oda.tmforum.org/componentName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vodafone-productcatalog</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">ports</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span>
    <span class="nt">targetPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">productcatalog</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">productcatalog</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">NodePort</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">productcatalog</span>
</pre></div>
</div>
<p>When this component is deployed, the <a class="reference external" href="https://github.com/tmforum-rand/oda-component-definitions/tree/master/controllers/componentOperator">Component Operator</a> will use this information to build a parent relationship between the running instances of the component. This also means that when we delete a component using the <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">delete</span> <span class="pre">component</span> <span class="pre">&lt;componentname&gt;</span></code> comand, the Kubernetes garbage-collection will also delete all the standard resources within the component.</p>
<p>The component operator will create a parent-&gt;child relationship with any labelled resources (services, deployments, persistentvolumeclaims, jobs, cronjobs, statefulsets, configmap, secret, serviceaccount, role, rolebinding) to make them part of the component (and help with things like cascading deletion)</p>
<p>We should not support certain resources:</p>
<ul class="simple">
<li><p>ingress - A developer should express a components intent via APIs and not via ingress. The canvas should create any required ingress</p></li>
<li><p>pod, replicaset - a developer should use deployments (for stateless microservices) or statefulsets (for stateful microservices)</p></li>
<li><p>demonset - a component developer should have no need for creating a demonset</p></li>
<li><p>clusterrole, clusterrolebinding - a component developer should have no need for creating a clusterrole, clusterrolebinding they should be using role, rolebinding</p></li>
</ul>
<p>This if you include these unsupported resources in a component specification, the component CTK will issue a warning.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="ODACanvasDesignGuidelines.html" class="btn btn-neutral float-right" title="Design Guidelines to design an ODA Canvas" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="ODAComponentTutorial/README.html" class="btn btn-neutral float-left" title="Tutorial to build ODA-Component from Open-API Reference Implemenation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, TM Forum ODA-Component Accelerator project.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>